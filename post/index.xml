<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Jane Wang&#39;s private blog</title>
    <link>/post/</link>
    <description>Recent content in Posts on Jane Wang&#39;s private blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2017 Jane Wang</copyright>
    <lastBuildDate>Sun, 01 Jan 2017 00:00:00 +0800</lastBuildDate>
    <atom:link href="/post/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Feynman&#39;s words</title>
      <link>/post/feynman-words/</link>
      <pubDate>Tue, 31 Oct 2017 00:00:00 +0800</pubDate>
      
      <guid>/post/feynman-words/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;These words come from Feynman&amp;rsquo;s &lt;a href=&#34;https://twitter.com/proffeynman&#34; target=&#34;_blank&#34;&gt;twitter&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;It doesn&amp;rsquo;t matter how beautiful your theory is. If it disagrees with experiment, it&amp;rsquo;s wrong. In that simple statement is the key to science.&lt;/li&gt;
&lt;li&gt;We must be careful not to believe things simply because we want them to be true. No one can fool you as easily as you can fool yourself!&lt;/li&gt;
&lt;li&gt;I was an ordinary person who studied hard. There&amp;rsquo;s no miracle people!&lt;/li&gt;
&lt;li&gt;hours ago Teach principles not formulas.&lt;/li&gt;
&lt;li&gt;There is no &amp;ldquo;authority&amp;rdquo; who decides what is a good idea.&lt;/li&gt;
&lt;li&gt;Religion is a culture of faith; science is a culture of doubt.&lt;/li&gt;
&lt;li&gt;Students should be made to think like scientists, be open-minded, curious, and especially, to doubt.&lt;/li&gt;
&lt;li&gt;Teach principles not formulas.&lt;/li&gt;
&lt;li&gt;There is no &amp;ldquo;authority&amp;rdquo; who decides what is a good idea.&lt;/li&gt;
&lt;li&gt;I&amp;rsquo;m smart enough to know that I&amp;rsquo;m dumb.&lt;/li&gt;
&lt;li&gt;We never are definitely right, we can only be sure we are wrong.&lt;/li&gt;
&lt;li&gt;Physics isn&amp;rsquo;t the most important thing. Love is.&lt;/li&gt;
&lt;li&gt;When we know that we actually live in uncertainty, then we ought to admit it; it is of great value to realize that we do not know answers!&lt;/li&gt;
&lt;li&gt;You&amp;rsquo;re unlikely to discover something new without a lot of practice on old stuff.&lt;/li&gt;
&lt;li&gt;The statements of science are not of what is true and what is not true, but statements of what is known with different degrees of certainty.&lt;/li&gt;
&lt;li&gt;It is imperative in science to doubt; it is absolutely necessary, for progress in science, to have uncertainty as a fundamental part of your inner nature. To make progress in understanding, we must remain modest and allow that we do not know.&lt;/li&gt;
&lt;li&gt;The only way to deep happiness is to do something you love to the best of your ability.&lt;/li&gt;
&lt;li&gt;If you cannot explain something in simple terms, you don&amp;rsquo;t understand it.&lt;/li&gt;
&lt;li&gt;Teach principles not formulas.&lt;/li&gt;
&lt;li&gt;Religion is a culture of faith; science is a culture of doubt.&lt;/li&gt;
&lt;li&gt;It is imperative in science to doubt; it is absolutely necessary, for progress in science, to have uncertainty as a fundamental part of your inner nature.&lt;/li&gt;
&lt;li&gt;We must be careful not to believe things simply because we want them to be true. No one can fool you as easily as you can fool yourself!&lt;/li&gt;
&lt;li&gt;Scientists are explorers. Philosophers are tourists.&lt;/li&gt;
&lt;li&gt;If you have any talent, any occupation that delights you, do it, and do it to the hilt. Don&amp;rsquo;t ask why or what difficulties you may get into.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>如何计算效应值（例如育种值）的准确性（accuracy）？</title>
      <link>/post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/</link>
      <pubDate>Sun, 01 Oct 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E5%80%BC-%E4%BE%8B%E5%A6%82%E8%82%B2%E7%A7%8D%E5%80%BC-%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7-accuracy/</guid>
      <description>&lt;p&gt;&lt;strong&gt;准确性&lt;/strong&gt;指的是&lt;strong&gt;预测效应值与真值之间的相关系数&lt;/strong&gt;。有时还会遇见一个概念——&lt;strong&gt;可靠性&lt;/strong&gt;（reliability）。可靠性是准确性的平方，也就是说这二者度量的是一个事情。&lt;strong&gt;reliability其实就是遗传力，这句很重要！！！&lt;/strong&gt;。遗传力主要用来计算选择响应（response to selection）。advisor说我的文章&lt;strong&gt;短&lt;/strong&gt;句子太多，不连贯，确实是这样LOL。
准确性的计算公式为：&lt;/p&gt;

&lt;p&gt;$$r=\sqrt{1-\frac{PEV}{\hat{\sigma}_a^2}}$$&lt;/p&gt;

&lt;p&gt;*PEV*是prediction error variances的缩写，意思是预测误差方差，预测误差是预测值与真值间的差，即：&lt;/p&gt;

&lt;p&gt;$$PEV=var(\hat g-g)=(1-r_{\hat g,g}^2)\sigma_a^2$$&lt;/p&gt;

&lt;p&gt;$\sigma_a^2$是加性方差。&lt;/p&gt;

&lt;p&gt;预测差值的标准误（*SED*）是可以从&lt;code&gt;Asreml&lt;/code&gt;中直接得到的，与*PEV*的关系是：&lt;/p&gt;

&lt;p&gt;$$
SED=\sqrt{\hat Var(BLUP.differences)}=\sqrt{\hat Var(\hat Y&lt;em&gt;i-\hat Y&lt;/em&gt;{i^`})}=\sqrt{2\hat Var(\hat Y)_i}=\sqrt{2PEV}
$$&lt;/p&gt;

&lt;p&gt;&lt;code&gt;我不知道上面这个公式怎么推导的。&lt;/code&gt;
所以有&lt;/p&gt;

&lt;p&gt;$$PEV=(SED)^&lt;sup&gt;2&lt;/sup&gt;&amp;frasl;&lt;sub&gt;2&lt;/sub&gt;=\hat Var(BLUP.differences)/2$$&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;在很长时间里我不知道（或者说模糊地知道）accuracy是怎么实现的。我知道公式，但在软件里分别和公式组分对应的部分是什么却不是很清楚，当然写这篇文字的时候是确定的。具体实现的途径有2：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;一是利用Asreml中的&lt;code&gt;prediction&lt;/code&gt;直接得到*SED*后，再根据公式4得出PEV&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;fm_pred &amp;lt;- predict(fm_asr, classify = &amp;quot;Fam&amp;quot;) #fm_asr是asreml()输出的对象， Fam是随机效应变量
SED &amp;lt;- fm_pred$predictions$avsed
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;二是逐步得到*PEV*，每个预测值都有一个*PEV*，是预测值*SE*平方的均值，所以从预测函数得到的对象中提取出*SE*平方后再平均即可&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;fm_pred &amp;lt;- predict(fm_asr, classify = &amp;quot;Fam&amp;quot;, present = &amp;quot;Plot&amp;quot;) #注意！这里预测的时候是要矫正掉其他的随机效应（如Plot）
SE &amp;lt;- fm_pred$predictions$pvals$standard.error
PEV &amp;lt;-  SE^2 %&amp;gt;% mean
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这里的*PEV*是一个向量，对应到每个水平上。
所以，总体上，*PEV*、*SED*和*SE*的关系是
$$PEV=(SED)^&lt;sup&gt;2&lt;/sup&gt;&amp;frasl;&lt;sub&gt;2&lt;/sub&gt;=ave(SE_i^2)$$&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;另外，在林元震老师的著作&lt;strong&gt;R与ASReml-R统计学&lt;/strong&gt;中（P474）也涉及到accuracy的代码&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;SE &amp;lt;- fm_asr$vcoeff$random * fm_asr$sigma2 #效应值se乘以sigma
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;结果是一样的，但不知道是否合理。&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;如果没有Asreml可能需要更底层的计算（比如手动），这时*PEV*的计算更直观些：
$$PEV=Var(\hat u-u)=diag(C^{22})\sigma_e^2=d_i\sigma_e^2=(1-r^2)\sigma_u^2$$
于是有
$$r^2=1-diag(C^{22})\frac{\sigma_e^2}{\sigma_u^2}$$&lt;/p&gt;

&lt;p&gt;$C^{22}$是方程组关联矩阵的逆矩阵的右下角块，$d_i$是块中的对角线元素。具体可查看&lt;a href=&#34;https://pan.baidu.com/s/1hrDRLeG&#34; target=&#34;_blank&#34;&gt;Pro. Isik编写的教材P84&lt;/a&gt;和&lt;a href=&#34;https://pan.baidu.com/s/1nvmT47n&#34; target=&#34;_blank&#34;&gt;Mrode, 2014的书P44&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;从*PEV*就可以得到我们需要的准确性和可靠性值了。&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;这个问题在群中还被讨论过
&lt;img src=&#34;http://upload-images.jianshu.io/upload_images/3289684-9908dc53ac300bbc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&#34; alt=&#34;accuracy_chat.jpg&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
